/*!
 * jQuery Scrollify
 * Version 0.1.15
 *
 * Requires:
 * - jQuery 1.6 or higher
 *
 * https://github.com/lukehaas/Scrollify
 *
 * Copyright 2016, Luke Haas
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(n){return t(n,e,e.document)}):"object"==typeof module&&module.exports?module.exports=function(n,o){return void 0===o&&(o="undefined"!=typeof window?require("jquery"):require("jquery")(n)),t(o,e,e.document),o}:t(jQuery,e,e.document)}("undefined"!=typeof window?window:this,function(e,t,n,o){"use strict";function i(n,o,i){if(M===!0)return!0;if(f[n]){if(b=!1,i&&D.before(n,p),m=1,D.sectionName&&(x!==!0||0!==n))if(history.pushState)try{history.replaceState(null,null,f[n])}catch(s){t.console&&console.warn("Scrollify warning: This needs to be hosted on a server to manipulate the hash value.")}else t.location.hash=f[n];if(o)e(D.target).stop().scrollTop(d[n]),i&&D.after(n,p);else{if(S=!0,jQuery().velocity?e(D.target).stop().velocity("scroll",{duration:D.scrollSpeed,easing:D.easing,offset:d[n],mobileHA:!1}):e(D.target).stop().animate({scrollTop:d[n]},D.scrollSpeed,D.easing),t.location.hash.length)try{e(t.location.hash).length&&t.console&&console.warn("Scrollify warning: There are IDs on the page that match the hash value - this will cause the page to anchor.")}catch(s){console.warn("Scrollify warning:",t.location.hash,"is not a valid jQuery expression, skipping hash value detection")}e(D.target).promise().done(function(){S=!1,x=!1,i&&D.after(n,p)})}}}function s(e){if(4>e)return!1;var t,n=20,o=0,i=e.length-1;for(e.length<2*n&&(n=Math.floor(e.length/2)),t=e.length-n;i>=t;i--)o+=e[i];var s=o/n;for(o=0,i=e.length-n-1,t=e.length-2*n;i>=t;i--)o+=e[i];var r=o/n;return s>=r?!0:!1}function r(e,t){for(var n=f.length;n>=0;n--)"string"==typeof e?f[n]===e&&(y=n,i(n,t,!0)):n===e&&(y=n,i(n,t,!0))}var c,a,u,h,l,d=[],f=[],p=[],g=[],y=0,m=1,v=!1,w=e(t).scrollTop(),b=!1,S=!1,E=!1,M=!1,H=[],T=(new Date).getTime(),x=!0,D={section:"section",sectionName:"section-name",interstitialSection:"",easing:"easeOutExpo",scrollSpeed:1100,offset:0,scrollbars:!0,axis:"y",target:"html,body",standardScrollElements:!1,setHeights:!0,before:function(){},after:function(){},afterResize:function(){},afterRender:function(){}};e.scrollify=function(o){function r(t){jQuery().velocity?e(D.target).stop().velocity("scroll",{duration:D.scrollSpeed,easing:D.easing,offset:t,mobileHA:!1}):e(D.target).stop().animate({scrollTop:t},D.scrollSpeed,D.easing)}function x(){var n=D.section;D.interstitialSection.length&&(n+=","+D.interstitialSection),e(n).each(function(n){D.setHeights?e(this).is(D.interstitialSection)?g[n]=!1:e(this).css("height","auto").outerHeight()<e(t).height()?(e(this).css({height:e(t).height()}),g[n]=!1):(e(this).css({height:e(this).height()}),g[n]=!0):e(this).outerHeight()<e(t).height()?g[n]=!1:g[n]=!0})}function j(n){var o=D.section;D.interstitialSection.length&&(o+=","+D.interstitialSection),e(o).each(function(n){n>0?d[n]=parseInt(e(this).offset().top)+D.offset:d[n]=parseInt(e(this).offset().top),D.sectionName&&e(this).data(D.sectionName)?f[n]="#"+e(this).data(D.sectionName).replace(/ /g,"-"):e(this).is(D.interstitialSection)===!1?f[n]="#"+(n+1):f[n]="#",p[n]=e(this),e(f[n]).length&&t.console&&console.warn("Scrollify warning: Section names can't match IDs on the page - this will cause the browser to anchor."),t.location.hash===f[n]&&(y=n,v=!0)}),!0===n?i(y,!1,!1):D.afterRender()}function I(){return w=e(t).scrollTop(),w>parseInt(d[y])?!1:!0}function L(){return w=e(t).scrollTop(),w<parseInt(d[y])+(p[y].height()-e(t).height())?!1:!0}e.easing.easeOutExpo=function(e,t,n,o,i){return t==i?n+o:o*(-Math.pow(2,-10*t/i)+1)+n},u={handleMousedown:function(){return M===!0?!0:(b=!1,void(E=!1))},handleMouseup:function(){return M===!0?!0:(b=!0,void(E&&u.calculateNearest()))},handleScroll:function(){return M===!0?!0:(c&&clearTimeout(c),void(c=setTimeout(function(){return E=!0,b===!1?!1:(b=!1,void u.calculateNearest())},200)))},calculateNearest:function(){w=e(t).scrollTop();for(var n,o=1,s=d.length,r=0,c=Math.abs(d[0]-w);s>o;o++)n=Math.abs(d[o]-w),c>n&&(c=n,r=o);(L()||I())&&(y=r,i(r,!1,!0))},wheelHandler:function(t,n){if(M===!0)return!0;if(D.standardScrollElements&&(e(t.target).is(D.standardScrollElements)||e(t.target).closest(D.standardScrollElements).length))return!0;g[y]||t.preventDefault();var o=(new Date).getTime();if(n=n||-t.originalEvent.detail/3||t.originalEvent.wheelDelta/120,o-T>1300&&(H=[]),T=o,H.length>=35&&H.shift(),H.push(Math.abs(10*n)),S)return!1;if(0>n){if(y<d.length-1&&L()){if(!s(H))return!1;t.preventDefault(),y++,S=!0,i(y,!1,!0)}}else if(n>0&&y>0&&I()){if(!s(H))return!1;t.preventDefault(),y--,S=!0,i(y,!1,!0)}},keyHandler:function(e){return M===!0?!0:void(38==e.keyCode?y>0&&I()&&(y--,i(y,!1,!0)):40==e.keyCode&&y<d.length-1&&L()&&(y++,i(y,!1,!0)))},init:function(){D.scrollbars?(e(t).bind("mousedown",u.handleMousedown),e(t).bind("mouseup",u.handleMouseup),e(t).bind("scroll",u.handleScroll)):e("body").css({overflow:"hidden"}),e(n).bind("DOMMouseScroll mousewheel",u.wheelHandler),e(n).bind("keydown",u.keyHandler)}},h={touches:{touchstart:{y:-1,x:-1},touchmove:{y:-1,x:-1},touchend:!1,direction:"undetermined"},options:{distance:30,timeGap:800,timeStamp:(new Date).getTime()},touchHandler:function(t){if(M===!0)return!0;if(D.standardScrollElements&&(e(t.target).is(D.standardScrollElements)||e(t.target).closest(D.standardScrollElements).length))return!0;var n;if("undefined"!=typeof t&&"undefined"!=typeof t.touches)switch(n=t.touches[0],t.type){case"touchstart":h.touches.touchstart.y=n.pageY,h.touches.touchmove.y=-1,h.touches.touchstart.x=n.pageX,h.touches.touchmove.x=-1,h.options.timeStamp=(new Date).getTime(),h.touches.touchend=!1;case"touchmove":h.touches.touchmove.y=n.pageY,h.touches.touchmove.x=n.pageX,h.touches.touchstart.y!==h.touches.touchmove.y&&Math.abs(h.touches.touchstart.y-h.touches.touchmove.y)>Math.abs(h.touches.touchstart.x-h.touches.touchmove.x)&&(t.preventDefault(),h.touches.direction="y",h.options.timeStamp+h.options.timeGap<(new Date).getTime()&&0==h.touches.touchend&&(h.touches.touchend=!0,h.touches.touchstart.y>-1&&Math.abs(h.touches.touchmove.y-h.touches.touchstart.y)>h.options.distance&&(h.touches.touchstart.y<h.touches.touchmove.y?h.up():h.down())));break;case"touchend":h.touches[t.type]===!1&&(h.touches[t.type]=!0,h.touches.touchstart.y>-1&&h.touches.touchmove.y>-1&&"y"===h.touches.direction&&(Math.abs(h.touches.touchmove.y-h.touches.touchstart.y)>h.options.distance&&(h.touches.touchstart.y<h.touches.touchmove.y?h.up():h.down()),h.touches.touchstart.y=-1,h.touches.touchstart.x=-1,h.touches.direction="undetermined"))}},down:function(){y<=d.length-1&&(L()&&y<d.length-1?(y++,i(y,!1,!0)):Math.floor(p[y].height()/e(t).height())>m?(r(parseInt(d[y])+e(t).height()*m),m+=1):r(parseInt(d[y])+(p[y].height()-e(t).height())))},up:function(){y>=0&&(I()&&y>0?(y--,i(y,!1,!0)):m>2?(m-=1,r(parseInt(d[y])+e(t).height()*m)):(m=1,r(parseInt(d[y]))))},init:function(){n.addEventListener&&(n.addEventListener("touchstart",h.touchHandler,!1),n.addEventListener("touchmove",h.touchHandler,!1),n.addEventListener("touchend",h.touchHandler,!1))}},l={refresh:function(e){clearTimeout(a),a=setTimeout(function(){x(),j(!0),e&&D.afterResize()},400)},handleUpdate:function(){l.refresh(!1)},handleResize:function(){l.refresh(!0)}},D=e.extend(D,o),x(),j(!1),!0===v?i(y,!1,!0):setTimeout(function(){i(0,!1,!0)},200),u.init(),h.init(),e(t).bind("resize",l.handleResize),n.addEventListener&&t.addEventListener("orientationchange",l.handleResize,!1)},e.scrollify.move=function(e){return e===o?!1:void r(e,!1)},e.scrollify.instantMove=function(e){return e===o?!1:void r(e,!0)},e.scrollify.next=function(){y<f.length&&(y+=1,i(y,!1,!0))},e.scrollify.previous=function(){y>0&&(y-=1,i(y,!1,!0))},e.scrollify.instantNext=function(){y<f.length&&(y+=1,i(y,!0,!0))},e.scrollify.instantPrevious=function(){y>0&&(y-=1,i(y,!0,!0))},e.scrollify.destroy=function(){D.setHeights&&e(D.section).each(function(){e(this).css("height","auto")}),e(t).unbind("resize",l.handleResize),D.scrollbars&&(e(t).unbind("mousedown",u.handleMousedown),e(t).unbind("mouseup",u.handleMouseup),e(t).unbind("scroll",u.handleScroll)),e(n).unbind("DOMMouseScroll mousewheel",u.wheelHandler),e(n).unbind("keydown",u.keyHandler),n.addEventListener&&(n.removeEventListener("touchstart",h.touchHandler,!1),n.removeEventListener("touchmove",h.touchHandler,!1),n.removeEventListener("touchend",h.touchHandler,!1)),d=[],f=[],p=[],g=[]},e.scrollify.update=function(){l.handleUpdate()},e.scrollify.current=function(){return p[y]},e.scrollify.disable=function(){M=!0},e.scrollify.enable=function(){M=!1},e.scrollify.isDisabled=function(){return M},e.scrollify.setOptions=function(n){"object"==typeof n?(D=e.extend(D,n),l.handleUpdate()):t.console&&console.warn("Scrollify warning: Options need to be in an object.")}});
